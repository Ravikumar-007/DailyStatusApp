/*!
 * MCAFEE RESTRICTED CONFIDENTIAL
 * Copyright (c) 2018 McAfee, LLC
 * 
 * The source code contained or described herein and all documents related
 * to the source code ("Material") are owned by McAfee or its
 * suppliers or licensors. Title to the Material remains with McAfee
 * or its suppliers and licensors. The Material contains trade
 * secrets and proprietary and confidential information of McAfee or its
 * suppliers and licensors. The Material is protected by worldwide copyright
 * and trade secret laws and treaty provisions. No part of the Material may
 * be used, copied, reproduced, modified, published, uploaded, posted,
 * transmitted, distributed, or disclosed in any way without McAfee's prior
 * express written permission.
 * 
 * No license under any patent, copyright, trade secret or other intellectual
 * property right is granted to or conferred upon you by disclosure or
 * delivery of the Materials, either expressly, by implication, inducement,
 * estoppel or otherwise. Any license under such intellectual property rights
 * must be expressed and approved by McAfee in writing.
 * 
 * 
 */!function(e){var t={};function s(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=t,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(a,r,function(t){return e[t]}.bind(null,r));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=31)}([function(e,t,s){"use strict";s.d(t,"a",function(){return i});var a=s(18),r=s(6);const i={uid:"{0DE9E47C-871A-4F90-8440-B190C216800A}",resourceReq:null,gtiRequestor:null,resourceRootURI:null,annotationProperties:null,balloonProperties:null,reputationReqCount:5,annotationEvents:null,activeBalloonElement:null,debugMode:!1,logger:new a.a(r.a.loglevel),activeURI:null,mapSelectors:new Map,cacheStats:{},imageCounter:0,eventHandler:null,debugTitle:"",onlyShowMcAfeeSecure:!1,bkGlobals:null,isSearchPage:!1}},function(e,t,s){"use strict";s.d(t,"a",function(){return i});var a=s(6),r=s(7);const i={browser:a.a.browsertype==r.b.Edge?browser:chrome}},,function(e,t,s){"use strict";var a=s(5),r=s(15);var i=s(16),o=s(8);var n=s(19);s.d(t,"a",function(){return c});const c={messageDispatcher:null,useNativeLogger:!1,logger:null,cache:new class{constructor(){this._reputationCache=new Map,this._GTIRequestsInProgress=new Set,this.setCleanUpTimer()}setCleanUpTimer(){setInterval(()=>{this._reputationCache.size>.5*a.a.maxCacheRecords&&this.cleanReputationCache()},36e5)}cleanReputationCache(){this._reputationCache.forEach((e,t,s)=>{Date.now()>r.b.reputationTTL+e.timeCached&&s.delete(t)})}addInProgress(e){this._GTIRequestsInProgress.add(e)}deleteInProgress(e){this._GTIRequestsInProgress.delete(e)}isInProgress(e){return this._GTIRequestsInProgress.has(e)}setReputation(e,t){this._reputationCache.size>a.a.maxCacheRecords||this._reputationCache.set(e,{timeCached:Date.now(),value:t})}getReputation(e){const t=this._reputationCache.get(e);return null!=t&&Date.now()>r.b.reputationTTL+t.timeCached?(this._reputationCache.delete(e),null):t}},options:new Map,blockPageMap:new Map,annotationOption:i.a.All,lastUrl:null,featureStats:new class{constructor(){this.Type=Object.freeze({PagesScanned:0,PagesBlocked:1,ItemsBlocked:2}),this.data={pagesScanned:0,pagesBlocked:0,itemsBlocked:0},this.read()}add(e){switch(e){case this.Type.PagesScanned:this.data.pagesScanned++;break;case this.Type.PagesBlocked:this.data.pagesBlocked++;break;case this.Type.ItemsBlocked:this.data.itemsBlocked++}this.save()}read(){o.a.get(o.a.storeVariables.POPUP_STATS,e=>{void 0!==e&&(this.data.pagesScanned=e.pagesScanned,this.data.pagesBlocked=e.pagesBlocked,this.data.itemsBlocked=e.itemsBlocked)})}save(){o.a.set(o.a.storeVariables.POPUP_STATS,this.data)}getData(){return this.data}},secureSearchProvider:-1,webadvisorSupportedFeatures:null,origUrlMap:new Map,ffViewports:null,tabIdToColourMap:new Map,externalExtns:new n.a,autoPlayNotificationRequired:!1,cryptojackingDisabled:!0,tabIdToLastClickTime:new Map,affid:"0",binaryVersion:"0.0.0.0",TabData:new Map,MsgQueue:new Map}},function(e,t,s){"use strict";s.d(t,"a",function(){return a});const a={gtirequest:"gtirequest",reportstat:"reportstat",sendTelemetry:"sendTelemetry",executecommand:"executecommand",ondoccomplete:"ondoccomplete",onredirectiframe:"onredirectiframe",onnavigate:"onnavigate",onoptionreceived:"onoptionreceived",getsupportedfeatures:"getsupportedfeatures",isframeblocked:"isframeblocked",whitelistediframe:"whitelistediframe",ispageblocked:"ispageblocked",logmsg:"logmsg",getres:"getres",showoptions:"showoptions",addpagescanstat:"addpagescanstat",whitelist:"whitelist",getbkglobals:"getbkglobals",setViewport:"setViewport",installExtension:"installExtension",getExtensionStatus:"getExtensionStatus",updateTopFrame:"updateTopFrame",autorunvideosite:"autorunvideosite",saveclickeventtime:"saveclickeventtime",getclickeventtime:"getclickeventtime",getValues:"getValues",cryptoBlock:"cryptoBlock"}},function(e,t,s){"use strict";s.d(t,"a",function(){return a});const a={uninstallUrl:"https://home.mcafee.com/root/landingpage.aspx?lpname=get-it-now",siteAdvisorUrl:"http://www.siteadvisor.com/",siteAdvisorUrlSecure:"https://www.siteadvisor.com/",siteReportUrl:"https://www.siteadvisor.com/sitereport.html",blockPageUrl:"https://www.siteadvisor.com/restricted.html",phishingPageUrl:"https://www.siteadvisor.com/phishing.html",maxCacheRecords:1e3,browsertype:"browsertype",useragent:"useragent",whitelistUrl:"about:blank?command=whitelist&token=1",domain:"domain",redirectURL:"redirectURL",originalURL:"originalURL",chromeExtensionVersion:"chromeExtVer",disabled:"disabled",viewport:"viewport",annonlyonssearch:"*OnlyShowAnnotationsOnSecureSearch",showicons:"*Icons",pnaclenabled:"Pnaclenabled",phishingcategory:169,SystemGEO:"SystemGEO",BingCountrySet:"BingCountrySet",ProviderForced:"ProviderForced",BingPartnerCode:"PC=MC",BingProvider:23,BingCountrySetString:"AU,DE",cookie:"Cookie",maxreservedcallbackid:5,WBUpsellDisabled:"WBUpsellDisabled",autoplaynotificationrequired:"AutoPlayNotificationRequired",CryptojackingDisabled:"CryptojackingDisabled",Affid:"*Affid",UseNativeLogger:"UseNativeLogger"}},function(e,t,s){"use strict";s.d(t,"a",function(){return a});const a={loglevel:0,debugmode:!1,browsertype:2,extnversion:"6.0.0.20782"}},function(e,t,s){"use strict";s.d(t,"b",function(){return a}),s.d(t,"a",function(){return r});const a={Unknown:-1,Firefox:1,Chrome:2,IronSource:3,Edge:4},r=function(e){switch(e){case a.Firefox:return"FF";case a.Chrome:return"CH";case a.Edge:return"ED";case a.IronSource:return"ISB"}return"Unknown"}},function(e,t,s){"use strict";s.d(t,"a",function(){return i});var a=s(1),r=s(11);const i={storeVariables:{TRUSTED_SITES:"trustedSites",SEARCH_OPTION:"searchOption",INSTALLED_DATE:"installedDate",DAILY_PING_LAST_SENT_TIME:"dailyPingLastSentTime",POPUP_STATS:"popupStats",CRYPTO_WHITELIST:"cryptoWhitelist"},set:function(e,t){const s={};s[e]=t,a.a.browser.storage.local.set(s)},get:function(e,t){a.a.browser.storage.local.get(e,s=>{t(s[e])})},remove:function(e){a.a.browser.storage.local.remove(e)},getTrustedSites:function(e){i.get(i.storeVariables.TRUSTED_SITES,e)},isSiteInTrustedSites:function(e,t){if(void 0===t)return!1;for(let s=0;s<t.length;++s)if(e.toLowerCase().includes(t[s].toLowerCase()))return!0;return!1},isSiteTrusted:function(e,t){const s=r.a.getCleanURI(e);i.getTrustedSites(e=>{void 0!==e&&i.isSiteInTrustedSites(s,e)?t({trusted:!0}):t({trusted:!1})})},addTrustedSite:function(e,t){i.getTrustedSites(s=>{const a=void 0===s?[]:s;i.isSiteInTrustedSites(e,a)||(a.push(e),i.set(i.storeVariables.TRUSTED_SITES,a)),t({added:!0})})},removeTrustedSite:function(e){let t=e;t=r.a.getCleanURI(t),i.getTrustedSites(e=>{if(void 0===e)return;const s=[];for(let a=0;a<e.length;++a)e[a].toUpperCase()!=t.toUpperCase()&&s.push(e[a]);i.set(i.storeVariables.TRUSTED_SITES,s)})}}},function(e,t,s){"use strict";s.d(t,"a",function(){return a});const a={SA_Green:0,SA_Yellow:1,SA_Red:2,SA_Unknown:3,SA_HackerSafe:4,SA_Cashback:5,SA_Disabled:6}},function(e,t,s){"use strict";s.d(t,"a",function(){return i});var a=s(1),r=s(4);class i{static logMsg(e){a.a.browser.runtime.sendMessage({command:r.a.logmsg,logDetails:e})}static saveLastClickedTime(){a.a.browser.runtime.sendMessage({action:r.a.saveclickeventtime,last_event:Date.now()})}static getLastClickedTime(e){a.a.browser.runtime.sendMessage({action:r.a.getclickeventtime},e)}static autoRunVideo(e){a.a.browser.runtime.sendMessage({command:r.a.autorunvideosite,Url:e})}static isPageBlocked(e,t){a.a.browser.runtime.sendMessage({command:r.a.ispageblocked,Url:e},t)}static isFrameBlocked(e,t){a.a.browser.runtime.sendMessage({command:r.a.isframeblocked,Url:e},t)}static getSupportedFeatures(e){a.a.browser.runtime.sendMessage({command:r.a.getsupportedfeatures},e)}static reportStat(e,t){a.a.browser.runtime.sendMessage({command:r.a.reportstat,Name:e,Value:t})}static makeGTIRequest(e,t,s,i,o){return a.a.browser.runtime.sendMessage({command:r.a.gtirequest,searchEngineType:t,Url:e,isSecureSearch:s,requestData:i},o),!0}static onNavigate(e,t){a.a.browser.runtime.sendMessage({command:r.a.onnavigate,Url:e,FrameId:t})}static executeCommand(e,t){a.a.browser.runtime.sendMessage({command:r.a.executecommand,commandId:e,params:t})}static addPageScanStat(){a.a.browser.runtime.sendMessage({command:r.a.addpagescanstat})}static whitelist(e,t,s,i){a.a.browser.runtime.sendMessage({command:r.a.whitelist,type:e,url:t,redirect_token:s,frame_id:i})}static getBkGlobals(e){a.a.browser.runtime.sendMessage({command:r.a.getbkglobals},e)}static domContentLoaded(){a.a.browser.runtime.sendMessage({command:r.a.ondoccomplete})}}},function(e,t,s){"use strict";s.d(t,"a",function(){return a});class a{static getURI(e){let t=e.split("?");return t.length>1?t[0]:(t=e.split("#")).length>1?t[0]:e}static getCleanURI(e){let t=e;return t.endsWith("/")&&(t=t.slice(0,-1)),t.startsWith("http://")?t=t.slice(7):t.startsWith("https://")&&(t=t.slice(8)),this.getURI(t)}static getParam(e,t){const s=e.indexOf("?");if(-1==s)return null;const a=e.substring(s+1).split("&");for(let e=0;e<a.length;++e){const s=a[e].indexOf("=");if(-1!=s&&a[e].substring(0,s)==t){return a[e].substring(s+1)}}return null}static getDomain(e){if(void 0===e||!/^https?:\/\//.test(e))return"";return new URL(e).hostname}}},function(e,t,s){"use strict";var a=s(9);const r={ScoreMinimal:15,ScoreUnknown:30,ScoreMedium:50};var i=s(7);const o={disabledChrome:1,disabledSafeBrowser:2,disabledFirefox:4,disabledEdge:8,disabledOpera:16};var n=s(5),c=s(20);s.d(t,"a",function(){return l});class l{static browserTypeToString(e){switch(e){case 1:return"FF";case 2:return"CH";case 3:return"ISB";case 4:return"ED"}return"UN"}static colorToImagePaths(e){let t="white";switch(e){case a.a.SA_Green:t="green";break;case a.a.SA_Yellow:t="yellow";break;case a.a.SA_Red:t="red";break;case a.a.SA_Unknown:t="white";break;case a.a.SA_HackerSafe:t="hackersafe";break;case a.a.SA_Disabled:t="disabled"}return c.a.toImagePaths(t)}static toColor(e){let t=a.a.SA_Unknown;return t=e<r.ScoreMinimal?a.a.SA_Green:e<r.ScoreUnknown?a.a.SA_Unknown:e<r.ScoreMedium?a.a.SA_Yellow:a.a.SA_Red}static isDisabled(e,t){const s=[{browser:i.b.Chrome,flag:o.disabledChrome},{browser:i.b.McAfeeSecureBrowser,flag:o.disabledSafeBrowser},{browser:i.b.Firefox,flag:o.disabledFirefox},{browser:i.b.Edge,flag:o.disabledEdge},{browser:i.b.Opera,flag:o.disabledOpera}];for(let a=0;a<s.length;++a)if(s[a].browser==t){return 0!==(s[a].flag&e)}return!1}static isSiteAdvisorURL(e){return!(!e.startsWith(n.a.siteAdvisorUrl)&&!e.startsWith(n.a.siteAdvisorUrlSecure))}static isHackerSafe(e){return 1&e}static isProperWebURL(e){return!!(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("ftp://"))}}},,,function(e,t,s){"use strict";s.d(t,"b",function(){return a}),s.d(t,"c",function(){return i}),s.d(t,"a",function(){return o});const a={reputationTTL:36e5,maxGTIQuestionLength:16384,globalSafeModeFlag:536870912,contentType:"application/json; charset=utf-8",clientId:"87d8d1082c2f2f821f438b2359b7a5b4",prn:"McAfee WebAdvisor",sdkv:"1.0",pv:s(6).a.extnversion,pev:1},r=64,i=function(){this.op=null,this.uop=r,this.url=null,this.catset=4},o=function(e){this.ci=new function(e){this.cliid=a.clientId,this.prn=a.prn,this.sdkv=a.sdkv,this.pv=a.pv,this.pev=a.pev,this.rid=e,this.affid="0"}(e),this.q=[]}},function(e,t,s){"use strict";s.d(t,"a",function(){return a});const a={Unknown:-1,None:1,OnlySecureSearch:2,All:4}},function(e,t,s){"use strict";s.d(t,"a",function(){return i});var a=s(0),r=s(1);class i{constructor(){this._messages=null}geti18nRes(e){return r.a.browser.i18n.getMessage(e)}getURI(e){let t=null;return t=null!=a.a.resourceRootURI?a.a.resourceRootURI+e:r.a.browser.runtime.getURL(e)}getImage(e,t){try{const s=new XMLHttpRequest,r=this.getURI("images/"+e);s.open("GET",r,!0),s.responseType="blob",s.onload=function(e){if(4==s.readyState&&200==s.status){const e=new FileReader;e.onloadend=function(){e.result;t(e.result)},e.readAsDataURL(s.response)}},s.onerror=function(t){a.a.logger.error("Failed in requesting html: "+e+t)},s.send(null)}catch(e){a.a.logger.error(e.message)}}getContent(e,t,s){try{const r=new XMLHttpRequest,i=this.getURI(t+e);r.open("GET",i,!0),"json/"==t&&r.overrideMimeType("application/json"),r.onload=function(e){4==r.readyState&&200==r.status&&s(r.responseText)},r.onerror=function(t){a.a.logger.error("Failed in requesting :"+e+t)},r.send(null)}catch(e){a.a.logger.error(e.message)}}getJSON(e,t){this.getContent(e,"json/",t)}getHtml(e,t){this.getContent(e,"html/",t)}getResStr(e,t){if(null!=a.a.resourceRootURI)if(null==this._messages){const s=window.navigator.language;this.getContent("messages.json","_locales/"+s,s=>{if(null!=s&&(this._messages=JSON.parse(s),null!=this._messages)){const s=this._messages[e];t(s.message)}})}else{const s=this._messages[e];t(s.message)}else{let s=r.a.browser.i18n.getMessage(e);"??"==s&&(s=""),t(s)}}}},function(e,t,s){"use strict";const a={None:0,Info:1,Err:2,All:3};var r=s(10),i=s(3),o=s(6),n=s(8);s.d(t,"a",function(){return c});class c{constructor(e){this.logLevel=e,this.nativeLoggingEnabled=!1,this.processType=-1,this.browserType=o.a.browsertype,this.extensionType="wa",n.a.get("ExtensionLogging",e=>{void 0!==e&&Number.isInteger(e)&&e>=0&&e<=3&&(this.logLevel=e)})}setNativeLoggingEnabled(e,t){void 0!==t&&(this.processType=t),this.nativeLoggingEnabled=e}log(e){if(this.nativeLoggingEnabled){const t={processType:this.processType,browserType:this.browserType,extensionType:this.extensionType,logLevel:a.Info,msg:e};0===this.processType?r.a.logMsg(t):i.a.messageDispatcher.CallFunction("logMsg",{logDetails:t})}if(a.Info&this.logLevel){const t=new Date;console.log(t.toLocaleString()+" "+e)}}error(e){if(this.nativeLoggingEnabled){const t={processType:this.processType,browserType:this.browserType,extensionType:this.extensionType,logLevel:a.Err,msg:e};0===this.processType?r.a.logMsg(t):i.a.messageDispatcher.CallFunction("logMsg",{logDetails:t})}if(a.Err&this.logLevel){const t=new Date;console.error(t.toLocaleString()+" "+e)}}}},function(e,t,s){"use strict";s.d(t,"a",function(){return a});class a{constructor(){this._extensionMap=new Map,this._extensionMap.set("WebBoost","klekeajafkkpokaofllcadenjdckhinm")}isWhiteListed(e){const t=this._extensionMap.values();for(const s of t)if(s===e)return!0;return!1}get(e){return this._extensionMap.get(e)}}},function(e,t,s){"use strict";s.d(t,"a",function(){return a});class a{static toImagePaths(e){let t="images/browser_action/";switch(e.startsWith("small_")?e:"small_"+e){case"small_button_green.gif":t+="green";break;case"small_button_yellow.gif":t+="yellow";break;case"small_button_red.gif":t+="red";break;case"small_button_grey.gif":t+="white";break;case"small_button_hs.gif":t+="hackersafe";break;case"small_button_disabled.gif":t+="disabled";break;default:t+=e}return{size16:t+"_16.png",size20:t+"_20.png",size32:t+"_32.png",size40:t+"_40.png"}}}},,,,function(e,t,s){"use strict";s.d(t,"a",function(){return a});const a={SearchEngine_NO_ENGINE:-1,SearchEngine_UNKNOWN:0,SearchEngine_GOOGLE:1,SearchEngine_YAHOO:2,SearchEngine_MSN:3,SearchEngine_AOL:4,SearchEngine_ASK:5,SearchEngine_UOL:6,SearchEngine_GOO:7,SearchEngine_MYWAY:8,SearchEngine_BAIDU:9,SearchEngine_LIVE:10,SearchEngine_TERRA:11,SearchEngine_COMCAST:12,SearchEngine_WEB:13,SearchEngine_BIGLOBE:14,SearchEngine_SONET:15,SearchEngine_COX:16,SearchEngine_GMX:17,SearchEngine_EXCITE:18,SearchEngine_SKY:19,SearchEngine_NATE:20,SearchEngine_NAVER:21,SearchEngine_NIFTY:22,SearchEngine_BING:23,SearchEngine_RAKUTAN:24,SearchEngine_YANDEX:25,SearchEngine_SN_LINKEDIN:26,SearchEngine_SN_GOOGLEPLUS:27,SearchEngine_SN_FACEBOOK:28,SearchEngine_WEBMAIL:100}},function(e,t,s){"use strict";s.d(t,"a",function(){return a});const a={block:"block",crypto:"crypto"}},,,,,,function(e,t,s){"use strict";s.r(t);var a=s(1),r=s(12),i=s(3),o=s(7),n=s(6),c=s(8),l=s(11),d=s(4);const g={BLOCKED:1};class u{constructor(){this._whitelist=null,this._blacklist=["wss://*.gasolina.ml/*","*://kissdoujin.com/Content/js/c-hive.js*","wss://*.sen-to-zdrowie.ml/*","*://cookiescript.info/libs/*","*://rocks.io/assets/*","*://coin-have.com/c/*","*://coinnebula.com/lib/*","wss://*.coin-have.com/","ws://digger.cryptobara.com/*","ws://*.webminepool.tk/*","*://*.lewd.ninja/static/m.js*","*://tokyodrift.ga/dropyoulike/a-o/*","*://*.2giga.link/hive/lib/*","*://papoto.com/lib/*","*://load.jsecoin.com/*","ws://*.1q2w3.fun/*","*://*/*plugins/ajcryptominer/assets/*","*://monerominer.rocks/miner.php*","*://minemytraffic.com/*","*://*.monerise.com/core/*","*://*.cookiescript.info/libs/*","ws://hive.tubetitties.com/*","wss://*.freecontent.racing/*","wss://*.hodling.faith/*","ws://gtg02.bestsecurepractice.com/proxy","*://cryptoloot.pro/lib/*","*://lmodr.biz/*","*://*.webminepool.com/lib/base.js","ws://*.sen-to-zdrowie.ml/*","ws://*.morningdigit.com/*","*://mine.nahnoji.cz/*","*://*.minescripts.info/*","*://jsecoin.com/server*","*://coinhive.com/lib*","wss://*.webminepool.tk/*","ws://*.monerise.com/proxy/*","*://kisshentai.net/Content/js/c-hive.js*","*://mataharirama.xyz/*","*://*.coinpirate.cf/*","ws://*.playerassets.info/*","wss://*.1q2w3.fun/*","*://*.1q2w3.fun/*","*://anime.reactor.cc/js/ch/cryptonight.wasm*","*://webmine.cz/miner*","wss://ws.l33tsite.info/*","*://coinhive.com/captcha*","wss://www.mutuza.win/proxy","*://*.morningdigit.com/*","ws://*.host.d-ns.ga/*","*://*.doubleclick5.xyz/*","*://miner.pr0gramm.com/xmr.min.js*","*://*.freecontent.bid/*","ws://lewd.ninja/comics/*","wss://*.monerise.com:9333/proxy/*","*://*.webminepool.com/lib/captcha.js","*://coinerra.com/lib/*","*://*.playerassets.info/*","wss://*.webmine.pro/*","wss://lewd.ninja/comics/*","*://*.doubleclick1.xyz/*","ws://*.freecontent.racing/*","*://*.googleanalytcs.com/*","wss://*.coinnebula.com/proxy*","ws://*.monerise.com:9333/proxy/*","ws://*.freecontent.loan/*","*://party-nngvitbizn.now.sh/*","wss://api.l33tsite.info/*","*://coinlab.biz/lib/coinlab.js*","wss://*.monerise.com/proxy/*","ws://www.mutuza.win/proxy","*://jscdndel.com/content/vidm.min.js*","*://listat.biz/*","*://minecrunch.co/web/*","ws://*.chainblock.science/*","*://baiduccdn1.com/lib/*","*://*.mutuza.win/worker.js","*://*.load.jsecoin.com/*","*://ppoi.org/lib/*","wss://*.chainblock.science/*","wss://*.crypto-loot.com/proxy*","wss://gtg02.bestsecurepractice.com/proxy","wss://*.coinhive.com/proxy*","*://coin-hive.com/captcha*","*://jsccnn.com/content/vidm.min.js*","*://monerominer.rocks/scripts/miner.js*","*://*.jsecoin.com/server*","*://server.jsecoin.com/*","wss://*.coin-hive.com/proxy*","*://*.doubleclick4.xyz/*","*://miner.cryptobara.com/client/*","*://*.rocks.io/assets/*","*://*.ppoi.org/lib/*","*://you.tubetitties.com/worker.js*","wss://*.googleanalytcs.com/*","wss://hive.tubetitties.com/*","*://static.reasedoper.pw/*","*://*.ppoi.org/token/*","ws://*.webmine.pro/*","*://you.tubetitties.com/hash.wasm*","*://*.doubleclick3.xyz/*","*://*.turnsocial.com/m.js","ws://*.hodling.faith/*","wss://*.morningdigit.com/*","*://*.ad-miner.com/lib/*","wss://*.2giga.link/wproxy*","ws://*.googleanalytcs.com/*","*://*.doubleclick6.xyz/*","ws://turnsocial.now.sh/*","*://cdn.cloudcoins.co/javascript/cloudcoins.min.js*","*://joyreactor.cc/ws/ch/*","*://minero.pw/miner.min.js*","*://*.webmine.pro/*","*://punchsub.net/chm.js","wss://mine.nahnoji.cz/*","wss://mine.torrent.pw/*","*://*.mutuza.win/lib/*","*://*.kickass.cd/power2/m.js","ws://*.cpu2cash.link/*","*://*.server.jsecoin.com/*","*://*.mutuza.win/processor.js","wss://turnsocial.now.sh/*","*://kiwifarms.net/js/Jawsh/xmr/xmr.min.js*","*://*.rocks.io/proxy*","*://crypto-loot.com/lib*","*://*.chmproxy.bid/lib/*","ws://*.gasolina.ml/*","*://*.stackpathdns.com/assets/javascript/cr.js","*://*.coinblind.com/lib/*","*://miner.pr0gramm.com/pm.min.js*","*://*.bewhoyouare.gq/*","wss://*.zlx.com.br/proxy*","*://a-o.ninja/apk-AO/kingofthenorth/*","*://ad-miner.com/lib/*","*://*.webminepool.com/api/*","*://*.cpu2cash.link/*","*://*.hemnes.win/*","*://ppoi.org/lib/*","wss://*.cpu2cash.link/*","ws://*.coinpirate.cf/*","ws://ws.l33tsite.info/*","*://digger.cryptobara.com/client/*","*://kickass.cd/m.js*","ws://*.zlx.com.br/proxy*","*://*.doubleclick2.xyz/*","*://*.amazonaws.com/doubleclick13/*","wss://*.freecontent.loan/*","*://*.host.d-ns.ga/*","*://*.candid.zone/youtube.com/*","ws://api.l33tsite.info/*","*://gtg2.bestsecurepractice.com/lib/*","wss://*.host.d-ns.ga/*","*://coin-hive.com/lib*","ws://mine.nahnoji.cz/*","wss://*.playerassets.info/*","*://*.afminer.com/code/*","wss://*.coinpirate.cf/*","*://cookiescriptcdn.pro/libs/*","*://*.goredirect.party/assets/*"]}Initialize(){n.a.browsertype===o.b.Chrome&&c.a.get(c.a.storeVariables.CRYPTO_WHITELIST,e=>{this._whitelist=new Set(e),a.a.browser.webRequest.onBeforeRequest.addListener(e=>{const t=i.a.TabData.get(e.tabId),s=l.a.getDomain(t);return this._whitelist.has(s)?{cancel:!1}:(this.NotifyCryptoBlock(e.tabId,s,e.url),i.a.logger.log(`Blocked crypto mining script/connection: ${e.url}`),{cancel:!0})},{urls:this._blacklist,types:["websocket","script","xmlhttprequest"]},["blocking"])})}NotifyCryptoBlock(e,t,s){const r=[...s].reverse().join(""),o={command:d.a.cryptoBlock,payload:{domain_url:t,crypto_miner:r}};a.a.browser.tabs.sendMessage(e,o,t=>{void 0===t&&i.a.MsgQueue.set(e,o)}),h.CryptoBlocked()}AddToWhitelist(e,t){const s=l.a.getDomain(e);""!==s&&(this._whitelist.add(s),c.a.set(c.a.storeVariables.CRYPTO_WHITELIST,Array.from(this._whitelist)),a.a.browser.tabs.reload(t,{bypassCache:!0}))}}class h{static onBeforeNavigate(e,t,s,a){i.a.messageDispatcher.CallFunction("onBeforeNavigate",{url:e,tab_id:t,frame_id:s,isBingSecureSearch:a})}static onNavigate(e,t,s,a){i.a.messageDispatcher.CallFunction("onNavigate",{url:e,tab_id:t,frame_id:s,bingPartnerCode:a})}static onDocComplete(e){i.a.messageDispatcher.CallFunction("onDocComplete",{url:e})}static CryptoBlocked(e){i.a.messageDispatcher.CallFunction("CryptoJackingHandler",{type:g.BLOCKED})}}var p=s(5);const m={activate:"activate",ondownloadfinished:"onDownloadFinished",reportstat:"reportStat",ondssrequest:"onDssRequest",onbeforenavigate:"onBeforeNavigate",onnavigate:"onNavigate",ondoccomplete:"onDocComplete",executecommand:"executeCommand",onMenuItemClick:"onMenuItemClick",setsystemoptionstring:"setSystemOptionString",getsystemoptionstring:"getSystemOptionString",getsystemoptionbool:"getSystemOptionBool",getsystemoptionint:"getSystemOptionInt",logmsg:"logMsg"};class b{constructor(){this.resolve=null,this.reject=null,this.promise=null,this.command=null,this.commandParams=null,this.pThis=null}createPromise(e,t,s,a,r,i){return this.resolve=t,this.reject=s,this.command=a,this.commandParams=r,this.pThis=i,this.promise=new Promise(e),this.promise}}var f=s(20);class w{static disable(e){null!=a.a.browser.browserAction&&a.a.browser.browserAction.disable(e)}static setTitle(e){null!=a.a.browser.browserAction&&a.a.browser.browserAction.setTitle({title:e})}static setIcon(e,t,s){null!=a.a.browser.browserAction&&(1==n.a.debugmode&&i.a.logger.log("Setting browser action for url: "+s+" to image: "+e.size32),void 0!==t?n.a.browsertype==o.b.Edge?a.a.browser.browserAction.setIcon({path:{20:e.size20,40:e.size40},tabId:t}):a.a.browser.browserAction.setIcon({path:{16:e.size16,32:e.size32},tabId:t}):n.a.browsertype==o.b.Edge?a.a.browser.browserAction.setIcon({path:{20:e.size20,40:e.size40}}):a.a.browser.browserAction.setIcon({path:{16:e.size16,32:e.size32}}))}}class _{constructor(e){this._port=e,this._callbackId=p.a.maxreservedcallbackid,this._messageMap={0:{}},this._viewport=null,this._icons=[],this._blockedFrames=new Map,this._contextCounter=0,this._contextMap=new Map,this.mcafee_wa_jscommands={addbitmap:"addBitmap",changebitmap:"changeBitmap",navigate:"navigate",urlfromcontext:"urlFromContext",getxyviewport:"getxyviewport"}}init(e){try{if(null!=this._port){if(this._port.onDisconnect.addListener(()=>{e({init:!1,disabled:!1})}),!this.setSystemOptionString(p.a.browsertype,i.a.browserType.toString()))return;if(!this.setSystemOptionString(p.a.useragent,navigator.userAgent))return;if(!this.nativeMsg([m.activate]))return;this.getSystemOptionString(p.a.disabled,"0",t=>{e({init:!0,disabled:t})}),this.getSystemOptionString(p.a.Affid,"0",e=>{i.a.affid=e}),this.getBingSecureSearchSettings()}}catch(e){return i.a.logger.error(e.message),!1}}isPageBlocked({url:e},t){t(!1,null)}nativeMsg(e){let t=!1;try{const s=[1,0].concat(e);t=this.postMessage(s)}catch(e){return i.a.logger.error(e.message),!1}return t}logMsg({logFlags:e,msg:t}){try{const s=[1,0,m.logmsg,e,t];this._port.postMessage(s)}catch(e){i.a.logger.error(e.message)}}postMessage(e){try{this._port.postMessage(e)}catch(e){return this._port.disconnect(),this._port=null,i.a.logger.error(e.message),!1}return!0}addNewContext(e,t,s,a){const r=""+t+s;this._contextMap.has(r)||this._contextMap.set(r,{tab_id:t,frame_id:s,context_id:e,url:a})}urlFromContext(e){const t=this.getContextObj(e);return null===t?"":t.url}getContextObj(e){const t=this._contextMap.entries();for(const s of t)if(s[1].context_id===e)return s[1];return null}navigateTab(e,t){const s=this.getContextObj(e),o=null===s?-1:s.frame_id,n=null===s?0:s.tab_id;if(i.a.logger.log("Navigate event received from native app for (tabid, frameId, uri) ,"+n+","+o+","+t),0===o)r.a.isSiteAdvisorURL(t)?a.a.browser.tabs.update(n,{url:t}):a.a.browser.tabs.get(n,e=>{if(r.a.isSiteAdvisorURL(e.url)){const e={};try{const e=new URL(t);i.a.origUrlMap.set(n,e.href)}catch(e){i.a.logger.log(`Invalid URL: ${t} from NativeJson, error: ${e.message}`)}e.url=i.a.origUrlMap.get(n),a.a.browser.tabs.update(n,e)}else a.a.browser.tabs.reload(n,{bypassCache:!0})});else{const e={};e.command=d.a.onredirectiframe,e.uri=t;let s=l.a.getParam(t,"domain");s=unescape(s),this._blockedFrames.set(s,t),i.a.logger.log("Send Message to frame: "+o+" uri: "+t),a.a.browser.tabs.sendMessage(n,e,e=>{void 0===e&&void 0!==a.a.browser.runtime.lastError&&i.a.logger.error(a.a.browser.runtime.lastError.message)})}}isFrameBlocked({frameUrl:e},t){const s=this._blockedFrames.get(e);i.a.logger.log("Checking whether iFrame is blocked for: "+e+". Status is : "+s),t({isBlocked:void 0!==s,redirectURI:s})}toPageImage(e){return e>=this._icons.length?null:f.a.toImagePaths(this._icons[e])}setBrowserActionIcon(e,t){const s=this.toPageImage(e);null!=s&&(i.a.tabIdToColourMap.set(t,s),a.a.browser.tabs.get(t,e=>{void 0===a.a.browser.runtime.lastError?w.setIcon(s,t,e.url):i.a.logger.log("Possible incorrect tab id, error message: "+a.a.browser.runtime.lastError.message)}))}changeBrowserAction(e,t){const s=this.getContextObj(e);null!==s&&0===s.frame_id&&this.setBrowserActionIcon(t,s.tab_id)}processOption(e,t){i.a.options.set(e,t),a.a.browser.tabs.query({},s=>{const r={command:d.a.onoptionreceived,optionName:e,optionValue:t};for(let e=0;e<s.length;e++)a.a.browser.tabs.sendMessage(s[e].id,r,null)})}SetXYViewport({xView:e,yView:t}){if(null!=this._viewport&&this._viewport.X==e&&this._viewport.Y==t)return;const s=e+","+t;this._viewport={X:e,Y:t},this.setSystemOptionString(p.a.viewport,s)}processInwardMessage(e){if(e.length<3){return-1==parseInt(e[0],10)&&(i.a.webadvisorSupportedFeatures=JSON.parse(e[1])),[]}switch(i.a.logger.log("Processing message from binary: "+e[2]+" "+e[3]+" "+e[4]+" "+e[5]),e[2]){case this.mcafee_wa_jscommands.addbitmap:return this._icons.push(e[3]),this._icons.length-1;case this.mcafee_wa_jscommands.changebitmap:this.changeBrowserAction(e[5],e[3]);break;case this.mcafee_wa_jscommands.navigate:this.navigateTab(e[5],e[3]);break;case this.mcafee_wa_jscommands.urlfromcontext:return this.urlFromContext(e[3]);case this.mcafee_wa_jscommands.getxyviewport:return this.getXYViewport()}}validateJSON(e){if(e.length<2)return;const t=parseInt(e[0],10);if(t>p.a.maxreservedcallbackid){const s=this._messageMap[t];if(null===s||void 0===s)return;s.waPromise.resolve({response:e,callback:s.callback,promise:s.waPromise}),delete this._messageMap[t]}else{const t=this.processInwardMessage(e);this.postMessage([0,e[1],t])}}setSystemOptionString(e,t){return this.nativeMsg([m.setsystemoptionstring,e,t])}getSystemOptionString(e,t,s){const a=void 0===s?null:s;return this.makePromise(m.getsystemoptionstring,a,[e,t])}getSystemOptionBool(e,t,s){const a=void 0===s?null:s;return this.makePromise(m.getsystemoptionbool,a,[e,t])}getSystemOptionInt(e,t,s){const a=void 0===s?null:s;return this.makePromise(m.getsystemoptionint,a,[e,t])}uninit(){null!=this._port&&(this._port.disconnect(),this._port=null)}then(e){try{switch(e.promise.command){case m.getsystemoptionbool:{const t=null==e.response[1]||e.response[1];e.promise.pThis.processOption(e.promise.commandParams[0],t),null!=e.callback&&e.callback(t);break}case m.getsystemoptionstring:e.promise.pThis.processOption(e.promise.commandParams[0],e.response[1]),null!=e.callback&&e.callback(e.response[1]);break;case m.getsystemoptionint:{let t;"null"==e.response[1]?[,t]=e.promise.commandParams:[,t]=e.response,e.promise.pThis.processOption(e.promise.commandParams[0],t),null!=e.callback&&e.callback(t);break}case m.ondssrequest:{const t=JSON.parse(e.response[1]);e.callback(t);break}}}catch(e){i.a.logger.error(e.message)}}makePromise(e,t,s){const a=++this._callbackId,r=new b,i=r.createPromise((t,r)=>{const i=[1,a,e].concat(s);this.postMessage(i)},this.then,null,e,s,this);return this._messageMap[a]={waPromise:r,callback:t},i.then(this.then),!0}makeGTIRequest({url:e,sourceType:t,isSecureSearch:s,requestData:a},r){const i="dssrequest:multiquery/MultiQuery?tojson=1&href="+e+"&sourceType="+t+"&ssearch="+s,o=a.join("\t");return this.makePromise(m.ondssrequest,r,[i,o])}onDownloadFinished({referrer:e,url:t,filename:s}){const a=null==e?"":e;return this.nativeMsg([m.ondownloadfinished,t,s,a]),!1}reportStat({request:e}){i.a.logger.log("Stat: "+e.Name+" Value: "+e.Value);const t="string"==typeof e.Value?e.Value:e.Value.toString();return this.nativeMsg([m.reportstat,e.Name,t]),!1}onSettings({url:e}){return a.a.browser.tabs.query({active:!0,currentWindow:!0},t=>{if(0!==t.length){const s=this.generateContextId(t[0].id,0);this.addNewContext(s,t[0].id,0,e),this.nativeMsg([m.onMenuItemClick,114,s.toString()])}}),!1}onDocComplete({url:e}){return this.nativeMsg([m.ondoccomplete,e,"",0,!0]),!1}documentFullyLoaded(){this._contextMap.clear()}generateContextId(e,t){const s=""+e+t;return this._contextMap.has(s)?this._contextMap.get(s).context_id:(this._contextCounter++,2147483647&(0|this._contextCounter))}onBeforeNavigate({url:e,tab_id:t,frame_id:s,isBingSecureSearch:a}){0===s&&this._blockedFrames.clear();const r=this.generateContextId(t,s);let o=r;a&&(o|=2147483648),this.addNewContext(r,t,s,e),i.a.logger.log("onBeforeNavigate event called for (url, tab_id, frame_id, contextid) ("+e+","+t+","+s+","+r+")");const n=0==s;return this.nativeMsg([m.onbeforenavigate,e,o.toString(),r.toString(),n]),!1}onNavigate({url:e,tab_id:t,frame_id:s}){const a=this.generateContextId(t,s);this.addNewContext(a,t,s,e),i.a.logger.log("onNavigate event called for (url, tab_id, frame_id, contextid) ("+e+","+t+","+s+","+a+")");const r=0==s;return this.nativeMsg([m.onnavigate,e,a.toString(),a.toString(),r]),!1}executeCommand({command_id:e}){this.nativeMsg([m.executecommand,e,""])}getBingSecureSearchSettings(){this.getSystemOptionString(p.a.SystemGEO,"",e=>{this.getSystemOptionString(p.a.BingCountrySet,p.a.BingCountrySetString,t=>{this.getSystemOptionInt(p.a.ProviderForced,-1,s=>{if(""!==e&&""!==t&&-1!==s){t.split(",").includes(e)&&23===s&&(i.a.secureSearchProvider=s)}})})})}whitelist({url:e,redirect_token:t,tab_id:s,frame_id:a}){let r="";r=null!=e?p.a.whitelistUrl+"&whitelisturl="+e+"&"+p.a.redirectURL+"="+t:p.a.whitelistUrl+"&"+p.a.redirectURL+"="+t,this.onBeforeNavigate({url:r,tab_id:s,frame_id:a}),this.onNavigate({url:r,tab_id:s,frame_id:a})}}var v=s(9),y=s(16),S=s(15);class k{constructor(){this.disableLink=!1}}class I{constructor(){this.hackerSafe=!1,this.cashback=!1,this.recommendation=0,this.categories=[],this.score=0,this.linkConfig=new k}}class C{constructor(){this.args="&",this.baseURL="https://www.mcafee.com/threat-intelligence/site/default.aspx?url="}}class M{constructor(){this.siteReportLinkText="",this.siteReport=new C,this.CCHeader="",this.recommendations={},this.categories={}}}class T{constructor(){this.cashback=!1,this.showOnlyHackersafe=!1,this.highlite=!1,this.productName="McAfee WebAdvisor",this.showIcons=!0}}class x{constructor(){this.IsPremium=!1,this.features=new T,this.resources=new M}}class R{constructor(){this.config=new x,this.annotationMap={}}}class E{constructor(){this.safeSearchResponse=new R}}var D=s(17);class L{constructor(){this._response=new E,this._resourceRequestor=new D.a,this._gtiResponse=null,this._requestdata=null,this._categoryMap=new Map,this._cachedItems=[]}init(e,t){this._gtiResponse=e,this._requestdata=t}addCachedItem(e){this._cachedItems.push(e)}toRecommendationId(e,t){let s=0;switch(r.a.toColor(e)){case v.a.SA_Green:s=t?20031:20010;break;case v.a.SA_Yellow:s=20009;break;case v.a.SA_Red:s=20033;break;default:s=20008}return s}buildRecommendation(){const e=[20034,20008,20009,20031,20010,20033];for(let t=0;t<e.length;++t){const s=e[t],a="i18n_rec"+s;this._resourceRequestor.getResStr(a,e=>{this._response.safeSearchResponse.config.resources.recommendations[s]=e})}}buildLinkInfo(e,t){const s=new I;if(s.score=t.rep,s.hackerSafe=r.a.isHackerSafe(t.ufg),s.recommendation=this.toRecommendationId(s.score,s.hackerSafe),void 0!==t.cat)for(let e=0;e<t.cat.length;++e){const a=t.cat[e];s.categories.push(a),this._categoryMap.set(a,a)}this._response.safeSearchResponse.annotationMap[e]=s}prepareFromCacheResponse(){const e=this._cachedItems.length;for(let t=0;t<e;++t){const e=this._cachedItems[t];this.buildLinkInfo(e.uri,e.value.value)}}prepareFromGTIResponse(){const e=JSON.parse(this._gtiResponse);if(null===e||void 0===e||0===e.length)return;const t=""===e[0]?e[1]:e[0];if(0!==Object.keys(t).length||t.constructor!==Object)for(let e=0;e<t.a.length;++e){const s=t.a[e];if(void 0!==s.aflag&&s.aflag==S.b.globalSafeModeFlag)continue;const a=this._requestdata[e];i.a.cache.setReputation(a,s),this.buildLinkInfo(a,s)}}setHackerSafe(e,t){this._response.safeSearchResponse.config.features.showOnlyHackersafe=!1,i.a.annotationOption===y.a.OnlySecureSearch&&(e||(this._response.safeSearchResponse.config.features.showOnlyHackersafe=!0)),t()}prepareResponse(e,t,s){this.setHackerSafe(t,()=>{this._resourceRequestor.getResStr("i18n_readsiterep",e=>{this._response.safeSearchResponse.config.resources.siteReportLinkText=e,this.prepareFromGTIResponse(),this.prepareFromCacheResponse(),this.buildRecommendation(),this.buildCategories(),s(this._response)})})}buildCategories(){const e=this._categoryMap.keys();for(;;){const t=e.next();if(void 0===t||null===t||!0===t.done)break;const s="i18n_cat"+t.value;this._resourceRequestor.getResStr(s,e=>{this._response.safeSearchResponse.config.resources.categories[t.value]=e})}}}class P{constructor(e){this._gtiRequest=e,this._requestdata=null,this._builder=new L,this._fncallback=null,this._url=null,this._localcacheHits=0,this._localcacheMiss=0,this._issecureSearch=!1}processResponse(e){0===Object.keys(e[1]).length&&e[1].constructor===Object?null!==this._fncallback&&this._fncallback({failed:!0}):(this._builder.init(e,this._requestdata),this._builder.prepareResponse(this._url,this._issecureSearch,this._fncallback))}prepareBody(e,t){const s=new S.a(t);let a=0;for(let t=0;t<e.length;++t){const r=e[t],o=i.a.cache.getReputation(r);null==o?(s.q[a]=new S.c,s.q[a].op="url",s.q[a].url=r,++a,++this._localcacheMiss):(this._builder.addCachedItem({uri:r,value:o}),e.splice(t,1),--t,++this._localcacheHits)}return{body:s}}post(e,t,s,a,r){try{this._url=e,this._issecureSearch=s,this._fncallback=r;const t=a.slice(),o=this.prepareBody(a,1);return o.body.q.length>0?(this._requestdata=a,o.body):(this._requestdata=t,this._builder.init("[]",this._requestdata),this._builder.prepareResponse(this._url,this._issecureSearch,r),null)}catch(e){i.a.logger.error(e.message)}}}var A=s(25);class N{constructor(e){this._port=e,this._callbackId=p.a.maxreservedcallbackid,this._callbackMap=new Map,this._blockedFrames=new Map,this._browserStartSent=!1,this._CryptoJacking=null,this.settingType={NONE:0,INT:1,INT64:2,BOOL:3,STRING:4},this.extensionCommands={GetValuesResponse:0,ExecuteCommand:1,GTIResponse:2,Redirect:3,Refresh:4,Restart:5,LogMsg:6,SetBrowserAction:7,HandshakeGreeting:8,ExtensionStateResponse:9},this.nativeCommands={GetValues:0,SetValues:1,ExecuteCommand:2,BeforeNavigate:3,Navigate:4,GTIRequest:5,LogMsg:6,OnDownloadFinished:7,OnSettingsClick:8,HandshakeGreeting:9,Whitelist:10,AggregateData:11,GetExtensionStatus:12,InstallExtension:13,Telemetry:14,ExtensionStatusUpdate:15,AutoPlayVideoSite:16,CryptoJackingHandler:17}}init(e){try{null!==this._port&&(this._port.onDisconnect.addListener(()=>{e({init:!1,disabled:!1})}),this.HandshakeGreeting(),this.GetExtensionStatus({extension_id:i.a.externalExtns.get("WebBoost")}),this.setValues({scope:0,name:p.a.browsertype,value:i.a.browserType.toString(),type:this.settingType.STRING},{scope:0,name:p.a.useragent,value:navigator.userAgent,type:this.settingType.STRING}),this.getValues(e=>{i.a.affid=void 0===e[0].value?"0":e[0].value},[{scope:0,name:p.a.Affid}]),this.getBingSecureSearchSettings(),e({init:!0,disabled:"0"}))}catch(e){return i.a.logger.error(e.message),!1}}postMessage(e){try{this._port.postMessage(e)}catch(e){return this._port.disconnect(),this._port=null,i.a.logger.error(e.message),!1}return!0}autoPlayVideoSite({topDomain:e,srcVideo:t}){i.a.logger.log("Autoplay site found in page"+e);const s=this.IncrementCallbackID();this.postMessage({id:s,request_type:this.nativeCommands.AutoPlayVideoSite,payload:{site_domain:e,video_url:t}})}HandshakeGreeting(){const e=a.a.browser.runtime.getManifest();this.postMessage({id:0,request_type:this.nativeCommands.HandshakeGreeting,payload:{extn_version:e.version,browser_type:n.a.browsertype,user_agent:navigator.userAgent,extn_id:a.a.browser.runtime.id}})}GetExtensionStatus({extension_id:e},t){if(!i.a.externalExtns.isWhiteListed(e))return;let s=0;void 0!==t&&"function"==typeof t&&(s=this.IncrementCallbackID(),this._callbackMap.set(s,t)),this.postMessage({id:s,request_type:this.nativeCommands.GetExtensionStatus,payload:{extension_id:e}})}isPageBlocked({url:e},t){t(!1,null)}nativeMsg(e){let t=!1;try{t=this.postMessage(e)}catch(e){return i.a.logger.error(e.message),!1}return t}logMsg({logDetails:e}){try{this._port.postMessage({request_type:this.nativeCommands.LogMsg,id:0,payload:{process_type:0===e.processType?"ct":"bg",browser_type:e.browserType,extension_type:e.extensionType,log_level:e.logLevel,msg:e.msg}})}catch(t){i.a.logger.error(`Failed to logMsg with log details: ${JSON.stringify(e)}. Exception: ${t.message}`)}}redirectTab({top_most:e,tab_id:t,redirect_url:s}){if(i.a.logger.log(`Navigate event received from native app for (tabid, top_most, uri), ${t}, ${e}, ${s}`),e)if(r.a.isSiteAdvisorURL(s)){const e={};e.url=s,a.a.browser.tabs.update(t,e)}else a.a.browser.tabs.get(t,e=>{if(r.a.isSiteAdvisorURL(e.url)){const e={};try{const e=new URL(s);i.a.origUrlMap.set(t,e.href)}catch(e){i.a.logger.log(`Invalid URL: ${s} from NativeJson, error: ${e.message}`)}e.url=i.a.origUrlMap.get(t),a.a.browser.tabs.update(t,e)}else a.a.browser.tabs.reload(t,{bypassCache:!0})});else{const r={};r.command=d.a.onredirectiframe,r.uri=s;let o=l.a.getParam(s,"domain");o=unescape(o),this._blockedFrames.set(o,s),i.a.logger.log("Send Message to top_most: "+e+" uri: "+s),a.a.browser.tabs.sendMessage(t,r,e=>{void 0===e&&void 0!==a.a.browser.runtime.lastError&&i.a.logger.error(a.a.browser.runtime.lastError.message)})}}isFrameBlocked({frameUrl:e},t){const s=this._blockedFrames.get(e);i.a.logger.log(`Checking whether iFrame is blocked for: ${e}. Status is : ${s}`),t({isBlocked:void 0!==s,redirectURI:s})}toPageImage(e){let t="white";switch(e){case v.a.SA_Green:t="green";break;case v.a.SA_Yellow:t="yellow";break;case v.a.SA_Red:t="red";break;case v.a.SA_Unknown:t="white";break;case v.a.SA_HackerSafe:t="hackersafe";break;case v.a.SA_Disabled:t="disabled"}return f.a.toImagePaths(t)}handleNativeHandshake(e){i.a.binaryVersion=void 0!==e.version?e.version:"0.0.0.0";const t=e.settings;if(void 0===t)return;t[p.a.UseNativeLogger]&&(i.a.useNativeLogger=!0,i.a.logger.setNativeLoggingEnabled(!0,1));const s=t[p.a.annonlyonssearch],a=t[p.a.showicons];void 0!==s&&void 0!==a?i.a.annotationOption=s&&a?y.a.OnlySecureSearch:a?y.a.All:y.a.None:i.a.logger.log("Failed to retrieve annotation's option");const r=t[p.a.CryptojackingDisabled];void 0===r||r||(i.a.cryptojackingDisabled=r,this._CryptoJacking=new u,this._CryptoJacking.Initialize());const o=t[p.a.autoplaynotificationrequired];void 0!==o&&(i.a.autoPlayNotificationRequired=o)}setBrowserActionIcon(e,t){const s=this.toPageImage(e);null!=s&&(i.a.tabIdToColourMap.set(t,s),a.a.browser.tabs.get(t,e=>{void 0===a.a.browser.runtime.lastError?w.setIcon(s,t,e.url):i.a.logger.log("Possible incorrect tab id, error message: "+a.a.browser.runtime.lastError.message)}))}processOption(e,t){if(Array.isArray(e)){for(const t of e)void 0!==t.name&&void 0!==t.value&&i.a.options.set(t.name,t.value);a.a.browser.tabs.query({},t=>{const s={command:d.a.onoptionreceived,options:e};for(let e=0;e<t.length;e++)a.a.browser.tabs.sendMessage(t[e].id,s,null)}),this._callbackMap.has(t)&&(this._callbackMap.get(t)(e),this._callbackMap.delete(t))}}SetXYViewport({xView:e,yView:t}){const s={X:e,Y:t};i.a.ffViewports=s,this._browserStartSent||(this.executeCommand({command_id:0,args:s}),this._browserStartSent=!0)}processInwardMessage(e){const t="id"in e?e.id:-1;switch(i.a.logger.log(`Processing message from binary: ${e.request_type} ${JSON.stringify(e.payload)}`),e.request_type){case this.extensionCommands.GetValuesResponse:this.processOption(e.payload.response,t);break;case this.extensionCommands.GTIResponse:if(!this._callbackMap.has(t))return!1;return this._callbackMap.get(t).processResponse(e.payload),this._callbackMap.delete(t),!0;case this.extensionCommands.HandshakeGreeting:i.a.logger.log("Binary version: "+e.payload.version),this.handleNativeHandshake(e.payload);break;case this.extensionCommands.SetBrowserAction:this.setBrowserActionIcon(e.payload.color,e.payload.tab_id);break;case this.extensionCommands.Redirect:this.redirectTab(e.payload);break;case this.extensionCommands.Restart:a.a.browser.runtime.reload();break;case this.extensionCommands.ExtensionStateResponse:if(i.a.options.set(e.payload.extension_id,e.payload.extension_state),this._callbackMap.has(t)){this._callbackMap.get(t)(e.payload.extension_state),this._callbackMap.delete(t)}}}validateJSON(e){if("request_type"in e&&"id"in e&&"payload"in e)try{this.processInwardMessage(e)}catch(t){return void i.a.logger.log(`Native json message may be missing some keys: ${JSON.stringify(e)} + ${t.message} `)}else i.a.logger.log(`Invalid native json message: ${JSON.stringify(e)} `)}setValues(...e){const t=this.IncrementCallbackID();return this.nativeMsg({request_type:this.nativeCommands.SetValues,id:t,payload:{VERB:"set-setting",PAYLOAD:e}})}getValues(e,t){const s=void 0===e?null:e,a=this.IncrementCallbackID();this._callbackMap.set(a,s),this.nativeMsg({request_type:this.nativeCommands.GetValues,id:a,payload:{VERB:"get-setting",PAYLOAD:t}})}uninit(){null!=this._port&&(this._port.disconnect(),this._port=null)}makeGTIRequest({url:e,sourceType:t,isSecureSearch:s,requestData:a},r){const i=new P,o=i.post(e,t,s,a,e=>{e.safeSearchResponse.stats={},e.safeSearchResponse.stats.localCacheHits=i._localcacheHits,e.safeSearchResponse.stats.localCacheMiss=i._localcacheMiss,r(e)});if(null===o)return!0;if(JSON.stringify(o).length>S.b.maxGTIQuestionLength)return!1;const n=this.IncrementCallbackID();return this._callbackMap.set(n,i),this.nativeMsg({request_type:this.nativeCommands.GTIRequest,id:n,payload:{request:JSON.stringify(o)}}),!0}onDownloadFinished({referrer:e,url:t,filename:s}){const a=null==e?"":e;return this.nativeMsg({request_type:this.nativeCommands.OnDownloadFinished,id:0,payload:{url:t,file_path:s,referrer:a}}),!1}onSettings({url:e}){const t=decodeURIComponent(e);this.nativeMsg({request_type:this.nativeCommands.OnSettingsClick,id:0,payload:{number:114,url:t}})}onBeforeNavigate({url:e,tab_id:t,frame_id:s}){0===s&&this._blockedFrames.clear();const a=0===s;i.a.logger.log(`onBeforeNavigate event called for (url, tab_id, frame_id) (${e}, ${t}, ${s})`),this.nativeMsg({request_type:this.nativeCommands.BeforeNavigate,id:0,payload:{top_most:a,url:e,tab_id:t}})}onNavigate({url:e,tab_id:t,frame_id:s,bingPartnerCode:a}){let r=e,o=0===s;void 0!==a&&(r=r+"&"+a,o=!0),i.a.logger.log(`onNavigate event called for (url, tab_id, frame_id) (${r}, ${t}, ${s})`),this.nativeMsg({request_type:this.nativeCommands.Navigate,id:0,payload:{top_most:o,url:r,tab_id:t}})}executeCommand({command_id:e,args:t}){this.nativeMsg({request_type:this.nativeCommands.ExecuteCommand,id:0,payload:{command_id:e,args:t}})}IncrementCallbackID(){return(this._callbackId<0||this._callbackId>=2147483647)&&(this._callbackId=p.a.maxreservedcallbackid),this._callbackId++}getBingSecureSearchSettings(){this.getValues(e=>{const t=void 0===e[0].value?"":e[0].value,s=void 0===e[1].value?p.a.BingCountrySetString:e[1].value,a=void 0===e[2].value?-1:e[2].value;if(""!==t&&""!==s&&-1!==a){s.split(",").includes(t)&&23===a&&(i.a.secureSearchProvider=a)}},[{scope:0,name:p.a.SystemGEO},{scope:0,name:p.a.BingCountrySet},{scope:0,name:p.a.ProviderForced}])}whitelist({type:e,url:t,redirect_token:s,tab_id:a,frame_id:r}){switch(e){case A.a.block:{const e=0===r;this.nativeMsg({request_type:this.nativeCommands.Whitelist,id:0,payload:{tab_id:a,top_most:e,url:t,redirect_token:s}})}break;case A.a.crypto:if(null===this._CryptoJacking)return;this._CryptoJacking.AddToWhitelist(t)}}aggregateData({extension_id:e,payload:t}){void 0!==e&&void 0!==t?this.nativeMsg({request_type:this.nativeCommands.AggregateData,id:0,payload:{extension_id:e,payload:t}}):i.a.logger.log(`Invalid external extension json message: ${JSON.stringify(t)} `)}installExtension({extension_id:e}){this.nativeMsg({request_type:this.nativeCommands.InstallExtension,id:0,payload:{extension_id:e}})}sendTelemetry(e){this.nativeMsg({request_type:this.nativeCommands.Telemetry,id:0,payload:{telemetry_data:e}})}extensionStatusUpdate({extension_id:e}){this.nativeMsg({request_type:this.nativeCommands.ExtensionStatusUpdate,id:0,payload:{extension_id:e}})}CryptoJackingHandler({type:e}){switch(e){case g.BLOCKED:this.nativeMsg({request_type:this.nativeCommands.CryptoJackingHandler,id:0,payload:{type:g.BLOCKED}})}}}var U=s(24);const O={isPhishingURI:function(e){if(void 0!==e.categories)for(let t=0;t<e.categories.length;++t)if(e.categories[t]==p.a.phishingcategory)return!0;return!1},toLinkInfo:function(e){const t={};return t.score=e.value.rep,t.categories=e.value.cat,t.hackerSafe=r.a.isHackerSafe(e.value.ufg),t.blockPageURL=e.blockPageURL,t},processLinkInfo:function(e,t,s,a,o){let n=r.a.toColor(a.score);if(n==v.a.SA_Red||n==v.a.SA_Yellow){i.a.logger.log("The site "+e+" is malicious");const r=O.isPhishingURI(a);i.a.messageDispatcher.CallFunction("CreateBlockPageURL",{url:e,top_most:t,is_phishing:r,color:n},t=>{if(""===t)return;const a=encodeURIComponent(e),r=l.a.getParam(t,p.a.originalURL);i.a.blockPageMap.set(r,a),s(o,t,n)})}else n==v.a.SA_Green&&1==a.hackerSafe&&(n=v.a.SA_HackerSafe),s(!0,e,n)},isSiteTrusted:function(e,t,s){if(!r.a.isProperWebURL(e))return s(!0,e,v.a.SA_Unknown),!0;if(r.a.isSiteAdvisorURL(e))return s(!0,e,v.a.SA_HackerSafe),!0;if(e.startsWith(p.a.whitelistUrl)){const t=l.a.getParam(e,p.a.domain);return s(!0,t,v.a.SA_Unknown),!0}return c.a.isSiteTrusted(e,a=>{if(i.a.cache.isInProgress(e))return;const r=i.a.cache.getReputation(e);if(void 0!==r){const i=O.toLinkInfo(r);O.processLinkInfo(e,t,s,i,a.trusted)}else i.a.cache.addInProgress(e),i.a.messageDispatcher.CallFunction("makeGTIRequest",{url:e,sourceType:U.a.SearchEngine_NO_ENGINE,isSecureSearch:!1,requestData:[e]},r=>{if(i.a.cache.deleteInProgress(e),void 0!==r.failed&&r.failed)return;const o=r.safeSearchResponse.annotationMap[e];O.processLinkInfo(e,t,s,o,a.trusted)})}),!0}};var q=s(0);class B{constructor(e){this._port=e,this._callbackId=0,this._callbackMap=new Map}init(e){return e({init:!0,disabled:"0"}),!0}makeGTIRequest({url:e,sourceType:t,isSecureSearch:s,requestData:a},r){const i=new P,o=i.post(e,t,s,a,e=>{void 0===e.failed&&(e.safeSearchResponse.stats={},e.safeSearchResponse.stats.localCacheHits=i._localcacheHits,e.safeSearchResponse.stats.localCacheMiss=i._localcacheMiss,r(e))});if(null===o)return!0;if(JSON.stringify(o).length>S.b.maxGTIQuestionLength)return!1;const n=this.IncrementCallbackID();return this._callbackMap.set(n,i),this.nativeMsg({id:n,type:"GtiRequest",payload:o}),!0}IncrementCallbackID(){return(this._callbackId<0||this._callbackId>=2147483647)&&(this._callbackId=0),this._callbackId++}CreateBlockPageURL({url:e,top_most:t,is_phishing:s,color:a},r){const i=this.IncrementCallbackID();this._callbackMap.set(i,r),this.nativeMsg({id:i,type:"BlockPageURL",payload:{url:e,top_most:t,is_phishing:s,color:a}})}onDownloadFinished({item:e}){return!1}reportStat({request:e}){if(void 0===e.EventType||void 0===e.ec)return!1;try{this.nativeMsg({type:"Telemetry",payload:e})}catch(e){i.a.logger.error(e.message)}return!1}onDocComplete(e){return!1}isPageBlocked({url:e},t){return O.isSiteTrusted(e,!0,(e,s,a)=>{t(!e,s)}),!0}nativeMsg(e){let t=!1;try{t=this.postMessage(e)}catch(e){return i.a.logger.error(e.message),!1}return t}postMessage(e){try{this._port.postMessage(e)}catch(e){return this._port.disconnect(),this._port=null,i.a.logger.error(e.message),!1}return!0}onBeforeNavigate({url:e,tab_id:t,frame_id:s}){const o=0===s;return O.isSiteTrusted(e,o,(n,c,l)=>{if(o){const s=r.a.colorToImagePaths(l);w.setIcon(s,t,e)}if(!n)if(o)i.a.logger.log("Redirecting tab "+t+" to URI "+c),r.a.isSiteAdvisorURL(c)&&i.a.featureStats.add(i.a.featureStats.Type.PagesBlocked),a.a.browser.tabs.update(t,{url:c},e=>{});else{const r={};r.command=d.a.onredirectiframe,r.uri=c,i.a.logger.log("Send Message to frame: "+s+" url: "+e),i.a.featureStats.add(i.a.featureStats.Type.ItemsBlocked),a.a.browser.tabs.sendMessage(t,r,e=>{void 0===e&&void 0!==a.a.browser.runtime.lastError&&i.a.logger.error(a.a.browser.runtime.lastError.message)})}}),!1}getWhitelistId(e){if(e.startsWith("about:blank?command=whitelist&token=")){const t=l.a.getParam(e,"redirectURL");if(null!=t)return{result:!0,wlistid:t}}return{result:!1,wlistid:-1}}onNavigate({url:e,tab_id:t,frame_id:s}){const r=this.getWhitelistId(e);if(1==r.result){const o=i.a.blockPageMap.get(r.wlistid);if(void 0!==o){const r=l.a.getParam(e,"whitelisturl");if(void 0!==r&&null!==r&&r===o){const e=decodeURIComponent(r),i=l.a.getCleanURI(e);c.a.addTrustedSite(i,r=>{if(void 0!==r&&!0===r.added)if(0===s){const s={};s.url=e,a.a.browser.tabs.update(t,s)}else{const e={};e.command=d.a.whitelistediframe,a.a.browser.tabs.sendMessage(t,e)}})}}}return!1}executeCommand({command_id:e,args:t}){return!1}logMsg({logFlags:e,msg:t}){}isFrameBlocked({frameUrl:e},t){O.isSiteTrusted(e,!1,(s,a,r)=>{t({isBlocked:!s&&a!=e,redirectURI:a})})}setSystemOptionString(e,t){c.a.set(e,t)}getSystemOptionString(e,t,s){const a=void 0===s?null:s;c.a.get(e,e=>{a(void 0!==e?e:t)})}getSystemOptionBool(e,t,s){const a=void 0===s?null:s;c.a.get(e,e=>{a(void 0!==e?e:t)})}whitelist({url:e,redirect_token:t,tab_id:s,frame_id:a}){let r="";r=null!=e?p.a.whitelistUrl+"&whitelisturl="+e+"&"+p.a.redirectURL+"="+t:p.a.whitelistUrl+"&"+p.a.redirectURL+"="+t,this.onNavigate({url:r,tab_id:s,frame_id:a})}processInwardMessage(e){const t="id"in e?e.id:-1;switch(i.a.logger.log(`Processing message from binary: ${JSON.stringify(e.payload)} ${e.type}`),e.type){case"GtiResponse":{const s=t,a=this._callbackMap.get(s),r="gti_response"in e.payload?e.payload.gti_response:"";a.processResponse(r),this._callbackMap.delete(s),q.a.logger.log("GtiRequest request to UWP completed");break}case"BlockPageResponse":{const s=t;this._callbackMap.get(s)("block_url"in e.payload?e.payload.block_url:""),this._callbackMap.delete(s),q.a.logger.log("Block page url request UWP completed");break}case"DebugInfo":q.a.logger.log(`Debug Info: ${JSON.stringify(e.payload)}`);break;default:q.a.logger.log("Not a supported Response type")}}validateJSON(e){const t=JSON.parse(e);if("payload"in t&&"id"in t&&"type"in t)try{this.processInwardMessage(t)}catch(t){i.a.logger.log(`Json message may be missing some keys: ${JSON.stringify(e)} + ${t.message} `)}else i.a.logger.log(`Invalid native json message: ${JSON.stringify(t)} `)}updateTopFrame({uri:e,tabId:t}){const s={};s.command=d.a.updateTopFrame,s.uri=e,a.a.browser.tabs.sendMessage(t,s)}HandshakeGreeting({install_date:e}){this.nativeMsg({id:-1,type:"HandshakeGreeting",payload:{install_date:e}})}}class F{constructor(){this._port=null,this._msgDispatcher=null}_InitNativeConnection(e){return this._port=a.a.browser.runtime.connectNative(e),null!==this._port||(i.a.logger.error("Failed to connect to Native Host"),!1)}_AddListener(e){this._port.onMessage.addListener(t=>{null===this._msgDispatcher&&(Array.isArray(t)?this._msgDispatcher=new _(this._port):this._msgDispatcher=new N(this._port),this._msgDispatcher.init(e)),this._msgDispatcher.validateJSON(t)})}_AddEdgeListener(e){this._port.onMessage.addListener(e=>{null!==e&&this._msgDispatcher.validateJSON(e)}),this._port.onDisconnect.addListener(()=>{this.port=null})}CallFunction(e,t,s){return null!==this._msgDispatcher&&"function"==typeof this._msgDispatcher[e]&&this._msgDispatcher[e](t,s)}InitDispatchFactory(e){switch(n.a.browsertype){case o.b.Edge:this._InitNativeConnection("WebAdvisorService")&&(this._msgDispatcher=new B(this._port),this._AddEdgeListener(),this._msgDispatcher.init(e));break;case o.b.Chrome:case o.b.Firefox:case o.b.IronSource:this._InitNativeConnection("siteadvisor.mcafee.chrome.extension")&&this._AddListener(e);break;default:i.a.logger.log("Not a valid browser")}}}const j={raisenewtabevent:3,showwelcomemessage:4};class G{init(){a.a.browser.tabs.onActivated.addListener(e=>{i.a.options.get(p.a.disabled)&&w.disable(e.tabId)}),a.a.browser.tabs.onCreated.addListener(e=>{if(i.a.options.get(p.a.disabled))return void w.disable(e.tabId);let t={};o.b.Firefox===n.a.browsertype&&(null!==i.a.ffViewports?t=i.a.ffViewports:i.a.logger.log("Warning: raising new tab without firefox viewports")),i.a.messageDispatcher.CallFunction("executeCommand",{command_id:j.raisenewtabevent,args:t})}),a.a.browser.tabs.onUpdated.addListener((e,t,s)=>{if("loading"===t.status&&i.a.TabData.set(e,s.url),"complete"===t.status){const t=i.a.MsgQueue.get(e);void 0!==t&&(a.a.browser.tabs.sendMessage(e,t),i.a.MsgQueue.delete(e))}if("complete"===t.status&&void 0!==s.url){const t=i.a.lastUrl;if(null==t||t!=s.url){i.a.lastUrl=s.url;const e="BrowserNavigate_"+r.a.browserTypeToString(i.a.browserType);i.a.messageDispatcher.CallFunction("reportStat",{request:{Name:e,Value:s.url}})}if(r.a.isSiteAdvisorURL(s.url)){const t=f.a.toImagePaths("hackersafe");w.setIcon(t,e,s.url)}else if(r.a.isProperWebURL(s.url))if(void 0!==O)O.isSiteTrusted(s.url,!0,(t,a,i)=>{const o=r.a.colorToImagePaths(i);w.setIcon(o,e,s.url)});else{const t=i.a.tabIdToColourMap.get(e);void 0!==t&&w.setIcon(t,e,s.url)}else{const t=f.a.toImagePaths("disabled");w.setIcon(t,e,s.url)}n.a.browsertype==o.b.Firefox&&r.a.isProperWebURL(s.url)&&i.a.messageDispatcher.CallFunction("executeCommand",{command_id:j.showwelcomemessage,args:""})}}),a.a.browser.tabs.onRemoved.addListener(e=>{i.a.tabIdToColourMap.delete(e),i.a.TabData.delete(e)})}}class V{getDomainName(e){let t=null;t=e.startsWith("http")||e.startsWith("www")?e:"https://"+e;const s=document.createElement("a");return s.setAttribute("href",t),s.hostname.startsWith("www.")?s.hostname.substr(4):s.hostname}init(){try{a.a.browser.runtime.onMessage.addListener((e,t,s)=>{let r=!1;try{switch(e.command){case d.a.SaveClickEventTime:i.a.tabIdToLastClickTime.set(t.tab.id,e.last_event);break;case d.a.GetClickEventTime:s(i.a.tabIdToLastClickTime.get(t.tab.id));break;case d.a.autorunvideosite:a.a.browser.tabs.get(t.tab.id,t=>{const s=this.getDomainName(t.url);i.a.messageDispatcher.CallFunction("autoPlayVideoSite",{topDomain:s,srcVideo:e.Url})});break;case d.a.ispageblocked:r=i.a.messageDispatcher.CallFunction("isPageBlocked",{url:e.Url},(e,t)=>{s(e,t)});break;case d.a.gtirequest:r=i.a.messageDispatcher.CallFunction("makeGTIRequest",{url:e.Url,sourceType:e.searchEngineType,isSecureSearch:e.isSecureSearch,requestData:e.requestData},s);break;case d.a.reportstat:r=i.a.messageDispatcher.CallFunction("reportStat",{request:e});break;case d.a.sendTelemetry:r=i.a.messageDispatcher.CallFunction("sendTelemetry",e.telemetry);break;case d.a.executecommand:r=i.a.messageDispatcher.CallFunction("executeCommand",{command_id:e.commandId,args:e.params});break;case d.a.isframeblocked:i.a.messageDispatcher.CallFunction("isFrameBlocked",{frameUrl:e.Url},s);r=!0;break;case d.a.logmsg:i.a.messageDispatcher.CallFunction("logMsg",{logDetails:e.logDetails});break;case d.a.getres:(new D.a).getResStr(e.resid,e=>{s(e)}),r=!0;break;case d.a.showoptions:i.a.messageDispatcher.CallFunction("onSettings",{url:e.Url});break;case d.a.addpagescanstat:i.a.featureStats.add(i.a.featureStats.Type.PagesScanned);break;case d.a.whitelist:i.a.messageDispatcher.CallFunction("whitelist",{type:e.type,url:e.url,redirect_token:e.redirect_token,tab_id:t.tab.id,frame_id:void 0===t.frameId?e.frame_id:t.frameId});break;case d.a.getbkglobals:s(i.a);break;case d.a.setViewport:i.a.messageDispatcher.CallFunction("SetXYViewport",{xView:e.X,yView:e.Y});break;case d.a.updateTopFrame:i.a.messageDispatcher.CallFunction("updateTopFrame",{uri:e.uri,tabId:t.tab.id});break;case d.a.installExtension:i.a.messageDispatcher.CallFunction("installExtension",{extension_id:e.extension_id});break;case d.a.getExtensionStatus:i.a.messageDispatcher.CallFunction("GetExtensionStatus",{extension_id:e.extension_id},e=>{s(e)}),r=!0;break;case d.a.getValues:i.a.messageDispatcher.CallFunction("getValues",e=>{s(e)},e.getList),r=!0;break;case d.a.ondoccomplete:i.a.messageDispatcher.CallFunction("documentFullyLoaded",{})}}catch(e){i.a.logger.error(e.message)}return r})}catch(e){i.a.logger.error(e.message)}}}class H{constructor(){this._bingPartnerCodeMap=new Map}init(){a.a.browser.webRequest.onSendHeaders.addListener(e=>{if(new URL(e.url).hostname.includes("bing"))for(const t of e.requestHeaders){if("cookie"!==t.name.toLowerCase())continue;const s=t.value.split(";");for(const t of s){const s=t.indexOf(p.a.BingPartnerCode);if(-1!==s){const a=t.substring(s,s+7);return void this._bingPartnerCodeMap.set(e.requestId,a)}}return}},{urls:["http://*/*","https://*/*","ftp://*/*"],types:["main_frame","sub_frame"]},["requestHeaders"]),a.a.browser.webRequest.onHeadersReceived.addListener(e=>{if(r.a.isSiteAdvisorURL(e.url))return;for(const t of e.responseHeaders)if("content-type"===t.name.toLowerCase()&&t.value.toLowerCase().startsWith("application/"))return;let t=!1;this._bingPartnerCodeMap.has(e.requestId)&&(t=!0),h.onBeforeNavigate(e.url,e.tabId,e.frameId,t)},{urls:["http://*/*","https://*/*","ftp://*/*"],types:["main_frame","sub_frame"]},["responseHeaders"]),a.a.browser.webRequest.onResponseStarted.addListener(e=>{if(r.a.isSiteAdvisorURL(e.url))return void(this._redirectedOnce=!1);for(const t of e.responseHeaders)if("content-type"===t.name.toLowerCase()&&t.value.toLowerCase().startsWith("application/"))return;let t;this._bingPartnerCodeMap.has(e.requestId)&&(t=this._bingPartnerCodeMap.get(e.requestId),this._bingPartnerCodeMap.delete(e.requestId)),h.onNavigate(e.url,e.tabId,e.frameId,t),h.onDocComplete(e.url)},{urls:["http://*/*","https://*/*","ftp://*/*"],types:["main_frame","sub_frame"]},["responseHeaders"]),a.a.browser.webRequest.onErrorOccurred.addListener(e=>{r.a.isSiteAdvisorURL(e.url)?this._redirectedOnce||(a.a.browser.tabs.update(e.tabId,{url:e.url}),this._redirectedOnce=!0):(this._bingPartnerCodeMap.delete(e.requestId),i.a.messageDispatcher.CallFunction("onNavigate",{url:e.url,tab_id:e.tabId,frame_id:e.frameId}))},{urls:["http://*/*","https://*/*"],types:["main_frame"]})}}class W{constructor(){this._externalCommands={PING:0},this._responseCommands={PONG:0}}init(){a.a.browser.runtime.onMessageExternal.addListener((e,t,s)=>(i.a.logger.log("Message from: "+t.id),!(void 0===t.id||!i.a.externalExtns.isWhiteListed(t.id))&&this.processMessage(t.id,e,s)))}processMessage(e,t,s){let a=!1;if(i.a.logger.log(`Message from: ${e} request: ${JSON.stringify(t)}`),!("request_type"in t&&"payload"in t))return i.a.logger.log(`Invalid external extension json message: ${JSON.stringify(t)} `),a;switch(t.request_type){case this._externalCommands.PING:i.a.logger.log("Got a ping"),s({request_type:this._responseCommands.PONG,useNativeLogger:i.a.useNativeLogger}),"WebBoost"===i.a.externalExtns.get(e)&&i.a.messageDispatcher.CallFunction("extensionStatusUpdate",{extension_id:e}),a=!1;break;default:i.a.messageDispatcher.CallFunction("postMessage",t)}return a}}class z{init(){i.a.logger.log("adding download listener");try{a.a.browser.downloads.onCreated.addListener(e=>{const t=setInterval(()=>{a.a.browser.downloads.search({id:e.id},e=>{0==e.length&&clearInterval(t);let s=!1;e.forEach(e=>{"complete"==e.state?(i.a.logger.log("Firing download finished for item: "+e.filename),i.a.messageDispatcher.CallFunction("onDownloadFinished",e)):"in_progress"==e.state&&(s=!0)}),s||clearInterval(t)})},1e3)})}catch(e){i.a.logger.error(e.message)}}}class J{nextCheckTime(e){c.a.get(c.a.storeVariables.DAILY_PING_LAST_SENT_TIME,t=>{const s=Date.now();e(void 0===t||s>=t+864e5?0:t+864e5-s)})}doDailyPing(){this.nextCheckTime(e=>{setTimeout(()=>{i.a.messageDispatcher.CallFunction("reportStat",{request:{EventType:"Event",ec:"DailyPing",ea:""}}),c.a.set(c.a.storeVariables.DAILY_PING_LAST_SENT_TIME,Date.now()),this.doDailyPing()},e)})}setInstalledDate(e){c.a.get(c.a.storeVariables.INSTALLED_DATE,t=>{let s=t;if(void 0===s){const e=new Date,t=e.getFullYear().toString(),a=(e.getMonth()+1).toString(),r=e.getDate().toString(),i=t+(a[1]?a:"0"+a)+(r[1]?r:"0"+r);c.a.set(c.a.storeVariables.INSTALLED_DATE,i),s=i}e(s)})}init(){this.setInstalledDate(e=>{i.a.messageDispatcher.CallFunction("HandshakeGreeting",{install_date:e}),this.doDailyPing()})}}class ${constructor(){this._listeners=[]}getListenersWhenDisabled(){return 0==this._listeners.length&&(this._listeners.push(new G),this._listeners.push(new V)),this._listeners}getListeners(){if(0==this._listeners.length)switch(this._listeners.push(new V),this._listeners.push(new G),this._listeners.push(new H),i.a.browserType){case o.b.Chrome:this._listeners.push(new W);break;case o.b.Firefox:this._listeners.push(new z);break;case o.b.Edge:this._listeners.push(new J)}return this._listeners}}var Y=s(18);(new class{processActiveTab(){a.a.browser.tabs.query({active:!0,currentWindow:!0},e=>{0!==e.length&&r.a.isProperWebURL(e[0].url)&&(h.onBeforeNavigate(e[0].url,e[0].id,0),h.onNavigate(e[0].url,e[0].id,0))})}handleDisabled(){i.a.messageDispatcher.CallFunction("uninit");const e=(new $).getListenersWhenDisabled();for(let t=0;t<e.length;++t)e[t].init();a.a.browser.tabs.query({active:!0,currentWindow:!0},e=>{0!=e.length&&w.disable(e[0].tabId)})}handleEnabled(){const e=(new $).getListeners();for(let t=0;t<e.length;++t)e[t].init();this.processActiveTab()}processInit(e){const t=parseInt(e,10),s=r.a.isDisabled(t,i.a.browserType);i.a.options.set(p.a.disabled,s),s?this.handleDisabled():this.handleEnabled()}main(){i.a.logger=new Y.a(n.a.loglevel),i.a.options.set(p.a.disabled,!1),i.a.browserType=n.a.browsertype,i.a.messageDispatcher=new F,i.a.messageDispatcher.InitDispatchFactory(e=>{!0===e.init&&this.processInit(e.disabled)})}}).main()}]);
//# sourceMappingURL=../sourceMap/chrome/mcafee_wa_background.map